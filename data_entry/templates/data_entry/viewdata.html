<!DOCTYPE html>
{% load static %}
<html>
<head>
    <meta charset='utf-8'>
    <title>Trackside Ops- View Data</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="stylesheet" href="{% static '/css/main.css' %}">
	<!-- Font awesome CDN -->
	<link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
	<!-- Bootstrap CDN -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
	<!-- end Bootstrap CDN -->
    <script src='main.js'></script>
</head>
<body style="background-color: #862334">
    <div class="header" style="background-color: #Bcbe25">
		<div class="row">
			<div class="col-md-4" align="left">
				<a href="{% url 'home' %}" class="logo">Trackside Ops</a>
			</div>
			<div class="col-md-4" align="left">
				<h2 align="center" class="display-6">View/Edit Data</h2>
			</div>
		</div>
    </div>
	<!-- The div below contains whole body of website -->
	<br>
    <div class="container" align="center">
		<!-- Row that contains dropdown and text box -->
		<div class="row">
			<div class="col-md-4" align="left"></div>
			<div class="col-md-2" align="right">
				<!-- "Select Field" Dropdown -->
				<select class="form-select" name="cars" id="fields">
					<option value="-1">Select a Field</option>
					<option value="0">Date</option>
					<option value="1">Driver</option>
					<option value="2">Track</option>
					<option value="3">Weather</option>
					<option value="4">Personnel</option>
					<option value="5">Location</option>
				</select>
			</div>
			<div class="col-md-4" align="left">
				<!-- Text box to filter -->
				<input class="form-control" onkeyup="filter()" type ="text" id="sandman" name="param" placeholder ="Search">
			</div>
			<div class=col-md-2 align="right"></div>
		<!-- End row that contains dropdown and text box -->
		</div>
		<br>
		<div class="row">
			<div class="col-md-12" >
				<table width="100%" class="table table-bordered table-hover table-striped" id="spiderman">
					<tr>
						<th style="color: #FFFFFF">Date</th>
						<th style="color: #FFFFFF">Drivers</th>
						<th style="color: #FFFFFF">Track</th>
						<th style="color: #FFFFFF">Weather</th>
						<th style="color: #FFFFFF">Personnel</th>
						<th style="color: #FFFFFF">Location</th>
					</tr>
					{% for entry in entries %}
						<tr>
							<td align="left" style="color: #FFFFFF">{{entry.created_at}}</td>
							<td align="left" style="color: #FFFFFF">{{entry.driver}}</td>
							<td align="left" style="color: #FFFFFF">{{entry.track}}</td>
							<td align="left" style="color: #FFFFFF">{{entry.weather}}</td>
							<td align="left" style="color: #FFFFFF">{{entry.personnel}}</td>
							<td align="left" style="color: #FFFFFF">{{entry.location}}</td>
							<td>
								<div class='btns'>
									<form action="{%url 'collectdata' %}" method="post">
										{% csrf_token %}
										<input type ="text" name="entry_id" style="display: none;" value={{entry.id}}>
										<input type ="text" name="method" style="display: none;" value="load">
										<input type=image class="btn-edit" src="{% static '/images/edit.png' %}">
									</form>   
									<form action="{%url 'view_data' %}" method="post">
										{% csrf_token %}
										<input type ="text" name="entry_id" style="display: none;" value={{entry.id}}>
										<input type ="text" name="method" style="display: none;" value="delete">
										<input type=image class="btn-delete" src="{% static '/images/delete.png' %}">
									</form>
								</div>                  
							</td>
						</tr>
					{% endfor %}
				</table>
			</div>
		</div>
    </div>
	<script>
		function filter() {
			var input, filter, table, tr, td, i, txtValue, index;
			input = document.getElementById("sandman");
			index = document.getElementById("fields").value
			filter = input.value.toUpperCase();
			table = document.getElementById("spiderman");
			tr = table.getElementsByTagName("tr");
			for (i = 0; i < tr.length; i++) {
				td = tr[i].getElementsByTagName("td")[index];
				if (td) {
					txtValue = td.textContent || td.innerText;
					if (txtValue.toUpperCase().indexOf(filter) > -1) {
						tr[i].style.display = "";
					} else {
						tr[i].style.display = "none";
					}
				}       
			}
		}
	</script>
</body>
</html>